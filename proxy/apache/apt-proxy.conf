# Apache reverse proxy for apt repositories.
# Enable modules: proxy proxy_http ssl headers

Listen 3142

<VirtualHost *:3142>
  ServerName apt-proxy.local

  SSLProxyEngine On
  ProxyPreserveHost On

  RequestHeader set X-Forwarded-Proto "http"

  ProxyPass        /ubuntu/          https://archive.ubuntu.com/ubuntu/
  ProxyPassReverse /ubuntu/          https://archive.ubuntu.com/ubuntu/

  ProxyPass        /ubuntu-security/ https://security.ubuntu.com/ubuntu/
  ProxyPassReverse /ubuntu-security/ https://security.ubuntu.com/ubuntu/

  ErrorLog  /var/log/apache2/apt-proxy-error.log
  CustomLog /var/log/apache2/apt-proxy-access.log combined
</VirtualHost>
